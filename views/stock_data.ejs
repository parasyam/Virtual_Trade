<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>InvestGo - Stock Details</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles/stock-data.css">
</head>

<body>
  <nav>
    <h1>Investfolio</h1>
    <div>
      <a href="/stock/get-watchlist">Watchlist</a>
      <a href="/stock/leaderboard">Leaderboard</a>
      <a href="/user/logout">Logout</a>
    </div>
  </nav>
  <div class="search-and-buttons">
    <!-- <div class="search-box-container">
      
      <input type="text" id="searchBox" placeholder="Search for a stock..." oninput="filterStocks()">
      <div id="suggestions"></div>

      
    </div> -->

    <div class="search-and-buttons">
      <div class="search-container">
        <input type="text" id="searchBox" placeholder="Search for a stock..." oninput="filterStocks()">
        <div class="suggestions" id="suggestions"></div>
      </div>
    </div>
    
  
    <div class="buttons">
      <button id="addToportfolioBtn" data-stock='{"symbol": "<%= symbol %>", "stockPrice": <%= stockPrice %>}'>Add to Portfolio</button>
      <button id="addToWatchlistBtn" data-stock='{"symbol": "<%= symbol %>"}'>Add to Watchlist</button>
    </div>
  </div>

 <div id="content">
  <div id="div0">
    <h4><%= symbol %></h4>
    <p><%= stockAbout %></p>
  </div>

  <div id="stock-details">
    <h2 style="grid-column: 1 / -1;">Stock Details</h2>

    <div class="detail-item"><strong>Symbol</strong> <%= symbol %></div>
    <div class="detail-item"><strong>Stock Price</strong> ₹<%= stockPrice %></div>
    <div class="detail-item"><strong>Industry</strong> <%= industry %></div>

    <div class="detail-item"><strong>Change %</strong> <%= changePercent %>%</div>
    <div class="detail-item"><strong>Market Cap</strong> ₹<%= marketCap %></div>
    <div class="detail-item"><strong>P/E Ratio</strong> <%= peRatio %></div>

    <div class="detail-item"><strong>52W Low</strong> ₹<%= yearLow %></div>
    <div class="detail-item"><strong>52W High</strong> ₹<%= yearHigh %></div>
    <div class="detail-item"><strong>Dividend</strong> ₹<%= dividend %></div>
  </div>
</div>


  

  <script>
    const stocks = [
      { symbol: "ADANIENT", name: "Adani Enterprises" },
      { symbol: "RELIANCE", name: "Reliance Industries" },
      { symbol: "TCS", name: "Tata Consultancy Services" },
      { symbol: "INFY", name: "Infosys" },
      { symbol: "HDFCBANK", name: "HDFC Bank" },
      { symbol: "ITC", name: "ITC Limited" },
    ];

    function filterStocks() {
      const input = document.getElementById('searchBox').value.toUpperCase();
      const suggestions = document.getElementById('suggestions');
      suggestions.innerHTML = "";
      if (input.length > 0) {
        const filteredStocks = stocks.filter(stock =>
          stock.name.toUpperCase().includes(input) || stock.symbol.toUpperCase().includes(input)
        );
        filteredStocks.forEach(stock => {
          const suggestionDiv = document.createElement('div');
          suggestionDiv.textContent = `${stock.name} (${stock.symbol})`;
          suggestionDiv.onclick = () => window.location.href = `/stock/${stock.symbol}`;
          suggestions.appendChild(suggestionDiv);
        });
        suggestions.style.display = 'block';
      } else {
        suggestions.style.display = 'none';
      }
    }

    document.getElementById("addToportfolioBtn").onclick = function () {
      const stockData = JSON.parse(this.getAttribute('data-stock'));
      let portfolio = JSON.parse(localStorage.getItem('portfolio')) || [];
      portfolio.push(stockData);
      localStorage.setItem('portfolio', JSON.stringify(portfolio));
      alert(`${stockData.symbol} added to Portfolio`);
    };

    document.getElementById("addToWatchlistBtn").onclick = function () {
      const stockData = JSON.parse(this.getAttribute('data-stock'));
      let watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
      watchlist.push(stockData);
      localStorage.setItem('watchlist', JSON.stringify(watchlist));
      alert(`${stockData.symbol} added to Watchlist`);
    };
  </script>
</body>

</html>
